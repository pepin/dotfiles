#!/bin/bash

function _ssh_auth_save()
{
    export HOSTNAME=`hostname`
    mkdir -p "$HOME/.screen/"
    ln -sf "$SSH_AUTH_SOCK" "$HOME/.screen/ssh-auth-sock.$HOSTNAME"
}

zsh_path=`which zsh`
case "$1" in
    "zsh")
        export SHELL="$zsh_path"
        ;;
    "bash")
        export SHELL="/bin/bash"
        ;;
esac

eval `ssh-agent`
ssh-add $HOME/.ssh/keys/*

_ssh_auth_save

if [ -e "$HOME/bin/screen" ]; then
    $HOME/bin/screen -d -R -U
else
    screen -d -R -U
fi
